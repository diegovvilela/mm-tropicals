// Independent translation system for watermelon page
const watermelonTranslations = {
    'pt-BR': {
        // Navigation and basic elements
        'nav.home': 'Início',
        'nav.about': 'Sobre',
        'nav.portfolio': 'Portfólio',
        'nav.quality': 'Qualidade',
        'nav.contact': 'Contato',
        'footer.text': '© 2026 Marques & Mariano Tropicals. Todos os direitos reservados.',
        'fruits.mango': 'Manga',
        'fruits.melon': 'Melão',
        'fruits.lime': 'Limão',
        'fruits.grape': 'Uva',
        'fruits.watermelon': 'Melancia',
        'fruits.banana': 'Banana',
        'fruits.coconut': 'Coco',
        'fruits.papaya': 'Mamão',
        // Watermelon specific
        'watermelon.title': 'Melancia',
        'watermelon.subtitle': 'Fruta grande, cuja polpa é doce, vermelha e com alto teor de água. Sua casca é espessa, e seu interior pode conter sementes ou não, dependendo da variedade.',
        'watermelon.seasonality.title': 'Sazonalidade',
        'watermelon.seasonality.high': 'Alta Disponibilidade',
        'watermelon.seasonality.medium': 'Média Disponibilidade',
        'watermelon.regions.title': 'Nossos Parceiros pelo Brasil',
        'watermelon.regions.saofrancisco.title': 'Principais Regiões Produtoras',
        'watermelon.regions.saofrancisco.description': 'Principais regiões produtoras do Brasil, reconhecidas pela excelência em tecnologia de irrigação.',
        'watermelon.regions.uruana': 'Berço da melanicultura irrigada brasileira desde 1968. Produtividade de 45 ton/hectare.',
        'watermelon.regions.teixeira': 'Maior produtor nacional com 391.528 toneladas anuais.',
        'watermelon.regions.rn': 'Segundo maior produtor. Qualidade premium com cultivo o ano todo.',
        'watermelon.regions.pe': 'Polo de inovação no semiárido. Produtividades recordes de até 61 ton/hectare.',
        'watermelon.varieties.title': 'Variedades',
        'watermelon.varieties.seedless.title': 'Seedless',
        'watermelon.varieties.seedless.description': 'Melancias sem sementes, ideais para consumo direto e exportação premium.',
        'watermelon.varieties.seeded.title': 'Com Sementes',
        'watermelon.varieties.seeded.description': 'Variedades tradicionais com sementes, sabor intenso e alta durabilidade.',
        'watermelon.commercialization.title': 'Comercialização',
        'watermelon.commercialization.packaging.title': 'Embalagem',
        'watermelon.commercialization.packaging.net': 'Peso Líquido:',
        'watermelon.commercialization.packaging.gross': 'Peso Bruto:',
        'watermelon.commercialization.pallet.title': 'Pallet',
        'watermelon.commercialization.pallet.boxes': 'Caixas por Pallet:',
        'watermelon.commercialization.calibers.title': 'Calibres',
        'watermelon.contact.title': 'Interessado em Melancia?',
        'watermelon.contact.subtitle': 'Entre em contato conosco para mais informações sobre disponibilidade, preços e especificações técnicas.',
        'watermelon.contact.cta': 'Solicitar Cotação',
        'months.jan': 'Jan',
        'months.feb': 'Fev',
        'months.mar': 'Mar',
        'months.apr': 'Abr',
        'months.may': 'Mai',
        'months.jun': 'Jun',
        'months.jul': 'Jul',
        'months.aug': 'Ago',
        'months.sep': 'Set',
        'months.oct': 'Out',
        'months.nov': 'Nov',
        'months.dec': 'Dez'
    },
    'en': {
        // Navigation and basic elements
        'nav.home': 'Home',
        'nav.about': 'About',
        'nav.portfolio': 'Portfolio',
        'nav.quality': 'Quality',
        'nav.contact': 'Contact',
        'footer.text': '© 2026 Marques & Mariano Tropicals. All rights reserved.',
        'fruits.mango': 'Mango',
        'fruits.melon': 'Melon',
        'fruits.lime': 'Lime',
        'fruits.grape': 'Grape',
        'fruits.watermelon': 'Watermelon',
        'fruits.banana': 'Banana',
        'fruits.coconut': 'Coconut',
        'fruits.papaya': 'Papaya',
        // Watermelon specific
        'watermelon.title': 'Watermelon',
        'watermelon.subtitle': 'Large fruit with sweet, red pulp and high water content. Its thick rind can contain seeds or not, depending on the variety.',
        'watermelon.seasonality.title': 'Seasonality',
        'watermelon.seasonality.high': 'High Availability',
        'watermelon.seasonality.medium': 'Medium Availability',
        'watermelon.regions.title': 'Our Partners Across Brazil',
        'watermelon.regions.saofrancisco.title': 'Main Production Regions',
        'watermelon.regions.saofrancisco.description': 'Main Brazilian producing regions, recognized for excellence in irrigation technology.',
        'watermelon.regions.uruana': 'Birthplace of Brazilian irrigated watermelon farming since 1968. 45 tons/hectare productivity.',
        'watermelon.regions.teixeira': 'Brazil\'s largest producer with 391,528 tons annually.',
        'watermelon.regions.rn': 'Second largest producer. Premium quality with year-round cultivation.',
        'watermelon.regions.pe': 'Semi-arid innovation hub. Record productivities up to 61 tons/hectare.',
        'watermelon.varieties.title': 'Varieties',
        'watermelon.varieties.seedless.title': 'Seedless',
        'watermelon.varieties.seedless.description': 'Seedless watermelons, ideal for direct consumption and premium export.',
        'watermelon.varieties.seeded.title': 'Seeded',
        'watermelon.varieties.seeded.description': 'Traditional varieties with seeds, intense flavor and high durability.',
        'watermelon.commercialization.title': 'Commercialization',
        'watermelon.commercialization.packaging.title': 'Packaging',
        'watermelon.commercialization.packaging.net': 'Net Weight:',
        'watermelon.commercialization.packaging.gross': 'Gross Weight:',
        'watermelon.commercialization.pallet.title': 'Pallet',
        'watermelon.commercialization.pallet.boxes': 'Boxes per Pallet:',
        'watermelon.commercialization.calibers.title': 'Calibers',
        'watermelon.contact.title': 'Interested in Watermelon?',
        'watermelon.contact.subtitle': 'Contact us for more information about availability, prices and technical specifications.',
        'watermelon.contact.cta': 'Request Quote',
        'months.jan': 'Jan',
        'months.feb': 'Feb',
        'months.mar': 'Mar',
        'months.apr': 'Apr',
        'months.may': 'May',
        'months.jun': 'Jun',
        'months.jul': 'Jul',
        'months.aug': 'Aug',
        'months.sep': 'Sep',
        'months.oct': 'Oct',
        'months.nov': 'Nov',
        'months.dec': 'Dec'
    },
    'es': {
        // Navigation and basic elements
        'nav.home': 'Inicio',
        'nav.about': 'Sobre',
        'nav.portfolio': 'Portafolio',
        'nav.quality': 'Calidad',
        'nav.contact': 'Contacto',
        'footer.text': '© 2026 Marques & Mariano Tropicals. Todos los derechos reservados.',
        'fruits.mango': 'Mango',
        'fruits.melon': 'Melón',
        'fruits.lime': 'Lima',
        'fruits.grape': 'Uva',
        'fruits.watermelon': 'Sandía',
        'fruits.banana': 'Plátano',
        'fruits.coconut': 'Coco',
        'fruits.papaya': 'Papaya',
        // Watermelon specific
        'watermelon.title': 'Sandía',
        'watermelon.subtitle': 'Fruta grande con pulpa dulce, roja y alto contenido de agua. Su cáscara es gruesa y su interior puede contener semillas o no, según la variedad.',
        'watermelon.seasonality.title': 'Estacionalidad',
        'watermelon.seasonality.high': 'Alta Disponibilidad',
        'watermelon.seasonality.medium': 'Disponibilidad Media',
        'watermelon.regions.title': 'Nuestros Socios por Brasil',
        'watermelon.regions.saofrancisco.title': 'Principales Regiones Productoras',
        'watermelon.regions.saofrancisco.description': 'Principales regiones productoras de Brasil, reconocidas por la excelencia en tecnología de riego.',
        'watermelon.regions.uruana': 'Cuna de la sandiacultura irrigada brasileña desde 1968. Productividad de 45 ton/hectárea.',
        'watermelon.regions.teixeira': 'Mayor productor nacional con 391.528 toneladas anuales.',
        'watermelon.regions.rn': 'Segundo mayor productor. Calidad premium con cultivo todo el año.',
        'watermelon.regions.pe': 'Polo de innovación en el semiárido. Productividades récord de hasta 61 ton/hectárea.',
        'watermelon.varieties.title': 'Variedades',
        'watermelon.varieties.seedless.title': 'Sin Semillas',
        'watermelon.varieties.seedless.description': 'Sandías sin semillas, ideales para consumo directo y exportación premium.',
        'watermelon.varieties.seeded.title': 'Con Semillas',
        'watermelon.varieties.seeded.description': 'Variedades tradicionales con semillas, sabor intenso y alta durabilidad.',
        'watermelon.commercialization.title': 'Comercialización',
        'watermelon.commercialization.packaging.title': 'Embalaje',
        'watermelon.commercialization.packaging.net': 'Peso Neto:',
        'watermelon.commercialization.packaging.gross': 'Peso Bruto:',
        'watermelon.commercialization.pallet.title': 'Pallet',
        'watermelon.commercialization.pallet.boxes': 'Cajas por Pallet:',
        'watermelon.commercialization.calibers.title': 'Calibres',
        'watermelon.contact.title': '¿Interesado en Sandía?',
        'watermelon.contact.subtitle': 'Contáctenos para más información sobre disponibilidad, precios y especificaciones técnicas.',
        'watermelon.contact.cta': 'Solicitar Cotización',
        'months.jan': 'Ene',
        'months.feb': 'Feb',
        'months.mar': 'Mar',
        'months.apr': 'Abr',
        'months.may': 'May',
        'months.jun': 'Jun',
        'months.jul': 'Jul',
        'months.aug': 'Ago',
        'months.sep': 'Sep',
        'months.oct': 'Oct',
        'months.nov': 'Nov',
        'months.dec': 'Dic'
    }
};

// Independent translation system
let currentLanguage = 'pt-BR';

const languageMeta = {
    'pt-BR': { flagClass: 'lang-flag--br', code: 'PT' },
    'en': { flagClass: 'lang-flag--en', code: 'EN' },
    'es': { flagClass: 'lang-flag--es', code: 'ES' }
};

function updateLanguageSelectorUI(lang) {
    const float = document.querySelector('.lang-float');
    if (!float) return;

    const toggle = float.querySelector('.lang-float-toggle');
    const toggleFlag = float.querySelector('.lang-float-toggle .lang-flag');
    const toggleCode = float.querySelector('.lang-float-toggle .lang-code');
    const meta = languageMeta[lang];

    if (toggleFlag && meta) {
        toggleFlag.classList.remove('lang-flag--br', 'lang-flag--en', 'lang-flag--es');
        toggleFlag.classList.add(meta.flagClass);
    }
    if (toggleCode && meta) toggleCode.textContent = meta.code;

    const options = float.querySelectorAll('.lang-option');
    options.forEach(opt => {
        opt.setAttribute('aria-selected', opt.getAttribute('data-lang') === lang ? 'true' : 'false');
    });

    if (toggle) toggle.setAttribute('aria-expanded', float.classList.contains('open') ? 'true' : 'false');
}

function changeLanguage(lang) {
    currentLanguage = lang;
    
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (watermelonTranslations[lang] && watermelonTranslations[lang][key]) {
            element.innerHTML = watermelonTranslations[lang][key];
        }
    });
    
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (watermelonTranslations[lang] && watermelonTranslations[lang][key]) {
            element.placeholder = watermelonTranslations[lang][key];
        }
    });
    
    updateLanguageSelectorUI(lang);

    if (window.lucide && typeof window.lucide.createIcons === 'function') {
        window.lucide.createIcons();
    }
    
    document.documentElement.lang = lang;
}

function saveLanguagePreference(lang) {
    localStorage.setItem('preferredLanguage', lang);
}

// Initialize watermelon page translation system
document.addEventListener('DOMContentLoaded', function() {
    // Sistema Híbrido: PT-BR para primeira visita, depois respeita preferência
    const savedLanguage = localStorage.getItem('preferredLanguage');
    const defaultLanguage = savedLanguage || 'pt-BR';
    
    changeLanguage(defaultLanguage);

    if (window.lucide && typeof window.lucide.createIcons === 'function') {
        window.lucide.createIcons();
    }

    // Hamburger menu functionality
    const hamburger = document.querySelector('.hamburger');
    const navMenu = document.querySelector('.nav-menu');
    const navLinks = document.querySelectorAll('.nav-menu a');

    if (hamburger && navMenu) {
        hamburger.addEventListener('click', function() {
            navMenu.classList.toggle('active');
            hamburger.classList.toggle('active');
        });

        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                // Don't close menu if clicking on portfolio toggle
                if (link.classList.contains('portfolio-toggle')) {
                    return;
                }
                navMenu.classList.remove('active');
                hamburger.classList.remove('active');
            });
        });
    }

    // Portfolio menu functionality
    const portfolioMenu = document.querySelector('.portfolio-menu');
    const portfolioToggle = document.querySelector('.portfolio-toggle');
    
    if (portfolioMenu && portfolioToggle) {
        // Click functionality for mobile
        portfolioToggle.addEventListener('click', function(e) {
            e.preventDefault();
            portfolioMenu.classList.toggle('active');
        });
        
        // Close when clicking outside
        document.addEventListener('click', function(e) {
            if (!portfolioMenu.contains(e.target)) {
                portfolioMenu.classList.remove('active');
            }
        });
    }

    // Language selector functionality
    const langFloat = document.querySelector('.lang-float');
    if (langFloat) {
        const toggle = langFloat.querySelector('.lang-float-toggle');
        const menu = langFloat.querySelector('.lang-float-menu');

        if (toggle) {
            toggle.addEventListener('click', function() {
                langFloat.classList.toggle('open');
                toggle.setAttribute('aria-expanded', langFloat.classList.contains('open') ? 'true' : 'false');
            });
        }

        langFloat.querySelectorAll('.lang-option').forEach(opt => {
            opt.addEventListener('click', function() {
                const lang = this.getAttribute('data-lang');
                changeLanguage(lang);
                saveLanguagePreference(lang); // Salva preferência quando usuário escolhe
                langFloat.classList.remove('open');
                if (toggle) toggle.setAttribute('aria-expanded', 'false');
            });
        });

        document.addEventListener('click', function(e) {
            if (!langFloat.contains(e.target)) {
                langFloat.classList.remove('open');
                if (toggle) toggle.setAttribute('aria-expanded', 'false');
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                langFloat.classList.remove('open');
                if (toggle) toggle.setAttribute('aria-expanded', 'false');
            }
        });

        if (menu) {
            menu.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }
    }

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Navbar scroll effect
    window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        if (navbar) {
            if (window.scrollY > 100) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        }
    });
});